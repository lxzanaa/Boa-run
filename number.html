<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Input Mask</title>
    <link rel="stylesheet" href="./public/css/styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<style>
</style>

<body>
    <!-- Modal Trigger Button -->
    <button id="open-modal-tel" class="px-4 py-2 bg-blue-500 text-white rounded">Open modal</button>

    <!-- Modal Overlay -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/50 opacity-0 transition-opacity duration-300 z-40 hidden">
    </div>

    <!-- Modal Content -->
    <div id="modal-content"
        class="fixed inset-0 flex items-center justify-center opacity-0 scale-90 transition-transform transition-opacity duration-300 z-50 hidden">
        <div
            class="bg-white border max-w-[1000px] w-full border-[#FFCC00] p-8 text-center transform transition-transform duration-300">
            <h2 class="text-[#873003] font-bold text-[45px] leading-[54.86px] mb-8">Оставляйте телефон, и мы перезвоним
                в рабочее время</h2>
            <form class="flex flex-col gap-6 justify-center mx-auto" action="">
                <input class="outline-none text-black font-medium text-xl text-center bg-transparent" type="text"
                    data-format="+* (***) ***-**-**" data-mask="+7 (___) ___-__-__" />
                <button
                    class="mx-auto inline-flex max-w-[250px] justify-center text-black font-bold text-xl px-6 py-3 rounded-[20px] bg-[#FFCC00] hover:bg-[#e6b800]">Жду
                    звонка</button>
            </form>
        </div>
    </div>






    <script>
        // Get the modal elements
        const modalContent = document.getElementById('modal-content');
        const modalOverlay = document.getElementById('modal-overlay');
        const openModalButton = document.getElementById('open-modal-tel');

        // Function to open the modal
        function openModal() {
            modalOverlay.classList.remove('hidden');
            modalOverlay.classList.add('opacity-100');
            modalContent.classList.remove('hidden', 'opacity-0', 'scale-90');
            modalContent.classList.add('opacity-100', 'scale-100');
            document.body.style.overflow = 'hidden';
        }

        // Function to close the modal
        function closeModal() {
            modalContent.classList.remove('opacity-100', 'scale-100');
            modalContent.classList.add('opacity-0', 'scale-90');
            modalOverlay.classList.remove('opacity-100');
            modalOverlay.classList.add('hidden');
            document.body.style.overflow = '';
        }

        // Event listener for opening the modal
        openModalButton.addEventListener('click', openModal);

        // Event listener for closing the modal when clicking on the overlay
        modalOverlay.addEventListener('click', closeModal);

        // Prevent clicks inside the modal content from closing the modal
        modalContent.addEventListener('click', (event) => {
            event.stopPropagation();
        });


    </script>
    <script>
        function doFormat(value, pattern, mask) {
            const strippedValue = value.replace(/[^0-9]/g, "");

            const chars = strippedValue.split('');


            let count = 0;
            let formatted = '';

            for (let i = 0; i < pattern.length; i++) {
                const char = pattern[i];
                if (chars[count]) {
                    if (/\*/.test(char)) {
                        formatted += chars[count];
                        count++;
                    } else {
                        formatted += char;
                    }
                }
                else if (mask) {
                    const splittedMask = mask.split('');

                    if (splittedMask[i]) {
                        formatted += splittedMask[i];
                    }
                }
            }


            return formatted;
        }


        document.querySelectorAll('[data-mask]').forEach(function (e) {


            function format(elem) {
                const val = doFormat(elem.value, elem.getAttribute('data-format'));
                elem.value = doFormat(elem.value, elem.getAttribute('data-format'), elem.getAttribute('data-mask'));

                if (elem.createTextRange) {
                    var range = elem.createTextRange();
                    range.move('character', val.length);
                    range.select();
                } else if (elem.selectionStart) {
                    elem.focus();
                    elem.setSelectionRange(val.length, val.length);
                }
            }

            e.addEventListener('keyup', function () {
                format(e);
            });

            e.addEventListener('keydown', function () {
                format(e);
            });

            format(e)
        });
    </script>
</body>

</html>